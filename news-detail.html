<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="img/Logo.jpg" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/news detail.css" />
    <link rel="stylesheet" href="css/mobile.css" media="(max-width: 768px)" />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Open+Sans:wght@300;400;600&family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
        .news-full-content {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .news-article-content {
            flex: 3;
            min-width: 300px;
        }

        .news-sidebar {
            flex: 1;
            min-width: 280px;
        }

        .related-product-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
            padding: 0.5rem;
            border-radius: 8px;
            transition: background-color 0.2s;
        }
        .related-product-item:hover {
            background-color: #f0f0f0;
        }

        .related-product-image {
            width: 70px;
            height: 70px;
            object-fit: cover;
            border-radius: 4px;
        }
        .related-product-details .name {
            font-weight: 600;
            margin: 0;
        }
        .related-product-details .price {
            margin: 0;
            font-size: 0.9em;
            color: #555;
        }

        @media (max-width: 768px) {
            .news-full-content {
                flex-direction: column;
            }
        }
    </style>
  </head>

  <body x-data>
    <div id="header-include"></div>

    <main class="main-content news-detail-page">
      <div class="container">
        <div class="news-layout" x-data="newsDetail">

          <!-- Loading State -->
          <p x-show="isLoading" x-text="$store.i18n.t('news.loading')">Memuat berita...</p>

          <!-- Not Found State -->
          <p x-show="!isLoading && notFound" x-text="$store.i18n.t('news.notFound')">Berita tidak ditemukan.</p>

          <!-- Main content, rendered only when newsItem is available -->
          <template x-if="newsItem">
            <div class="news-full-content">
              <!-- Left Column: Main Article -->
              <article class="news-article-content">
                <h1 x-text="newsTitle"></h1>
                <div class="news-meta">
                  <span>
                    <span x-text="$store.i18n.t('newsDetail.by')">By</span>
                    <strong x-text="$store.i18n.t('newsDetail.author')">Editorial Team</strong>
                  </span>
                  <span>|</span>
                  <span x-text="formattedDate"></span>
                </div>
                <div class="news-hero">
                  <img :src="newsItem.image_url || 'img/coming soon.jpg'" :alt="newsTitle" />
                </div>
                <div class="news-body" x-html="newsContent"></div>
                <div class="share-buttons">
                  <h4 x-text="$store.i18n.t('newsDetail.share')">Share This Article:</h4>
                  <a href="#" class="btn btn-icon-only"><i data-feather="facebook"></i></a>
                  <a href="#" class="btn btn-icon-only"><i data-feather="twitter"></i></a>
                  <a href="#" class="btn btn-icon-only"><i data-feather="mail"></i></a>
                </div>
              </article>

              <!-- Right Column: Sidebar -->
              <aside class="news-sidebar">
                <!-- Related Products Section: only shown if there are related products -->
                <template x-if="relatedProducts.length > 0">
                    <div class="sidebar-widget">
                        <h4 x-text="$store.i18n.t('productDetail.relatedProducts')">Related Products</h4>
                        <div class="related-products-list">
                            <template x-for="product in relatedProducts" :key="product.id">
                                <a :href="'product-details.html?id=' + product.id" class="related-product-item">
                                    <img :src="product.image_url" :alt="product.name[$store.i18n.lang] || product.name.id" class="related-product-image">
                                    <div class="related-product-details">
                                        <p class="name" x-text="product.name[$store.i18n.lang] || product.name.id"></p>
                                        <p class="price" x-text="formatRupiah(product.price)"></p>
                                    </div>
                                </a>
                            </template>
                        </div>
                    </div>
                </template>

                <div class="sidebar-widget">
                  <h4 x-text="$store.i18n.t('news.latest')">Latest News</h4>
                  <ul class="sidebar-news-list">
                    <template x-if="latestNews && latestNews.length > 0">
                      <template x-for="item in latestNews" :key="item.id">
                        <li>
                          <a :href="'news-detail.html?id=' + item.id">
                            <span x-text="item.title[$store.i18n.lang] || item.title.id"></span>
                            <small x-text="new Date(item.created_at).toLocaleDateString($store.i18n.lang, { year: 'numeric', month: 'short', day: 'numeric' })"></small>
                          </a>
                        </li>
                      </template>
                    </template>
                  </ul>
                </div>
              </aside>
            </div>
          </template>
        </div>
      </div>
    </main>

    <div id="notification" class="notification"></div>
    <div id="footer-include"></div>

    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-client.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.10/dist/cdn.min.js" defer></script>
    <script src="js/main.js"></script>
    <script src="js/news-detail.js"></script>
  </body>
</html>
