<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="icon" type="image/x-icon" href="img/Logo.jpg" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/news-detail.css" />
    <link rel="stylesheet" href="css/mobile.css" media="(max-width: 768px)" />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Open+Sans:wght@300;400;600&family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <style>
        .news-full-content {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .news-article-content {
            flex: 0 0 73%; /* Konten utama mengambil ~3/4 */
        }

        .news-sidebar {
            flex: 0 0 24%; /* Sidebar mengambil ~1/4 */
            min-width: 280px;
        }

        /* Styling for Related Products to match product cards */
        .related-product-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            border-radius: 10px;
            border: 1px solid rgba(0,0,0,0.08);
            background: #fff;
            margin-bottom: 1rem;
            transition: box-shadow 0.2s ease, transform 0.2s ease;
            text-decoration: none;
            color: inherit;
        }
        .related-product-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.08);
        }

        .related-product-item img {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 6px;
        }
        .related-product-details {
            flex: 1;
        }
        .related-product-details .name {
            font-weight: 700;
            margin: 0 0 0.25rem 0;
            font-size: 0.9rem;
            color: #333;
        }
        .related-product-details .price {
            margin: 0;
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--accent, #2e7d32);
        }

        @media (max-width: 768px) {
            .news-full-content {
                flex-direction: column;
            }
             .news-article-content, .news-sidebar {
                flex-basis: 100%; /* Lebar penuh di mobile */
            }
        }
    </style>
  </head>

  <body x-data>
    <div id="header-include"></div>

    <main class="main-content news-detail-page">
      <div class="container">
        <div class="news-layout" x-data="newsDetail">

          <!-- Loading State -->
          <p x-show="isLoading" x-text="$store.i18n.t('news.loading')">Memuat berita...</p>

          <!-- Not Found State -->
          <p x-show="!isLoading && notFound" x-text="$store.i18n.t('news.notFound')">Berita tidak ditemukan.</p>

          <!-- Main content, rendered only when newsItem is available -->
          <template x-if="newsItem">
            <div class="news-full-content">

              <!-- Left Column: Main Article -->
              <article class="news-article-content">
                <h1 x-text="newsTitle"></h1>
                <div class="news-meta">
                  <span>
                    <span x-text="$store.i18n.t('newsDetail.by')">By</span>
                    <strong x-text="$store.i18n.t('newsDetail.author')">Editorial Team</strong>
                  </span>
                  <span>|</span>
                  <span x-text="formattedDate"></span>
                </div>
                <div class="news-hero">
                  <img :src="window.fixImagePath(newsItem.image_url) || 'img/coming-soon.jpg'" :alt="newsTitle" />
                </div>
                <div class="news-body" x-html="newsContent"></div>
                <div class="share-buttons">
                  <h4 x-text="$store.i18n.t('newsDetail.share')">Share This Article:</h4>
                  <!-- Facebook -->
                  <a x-bind:href="facebookShareUrl" target="_blank" rel="noopener noreferrer" class="btn btn-icon-only" aria-label="Share on Facebook">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
                  </a>
                  <!-- Twitter -->
                  <a x-bind:href="twitterShareUrl" target="_blank" rel="noopener noreferrer" class="btn btn-icon-only" aria-label="Share on Twitter">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
                  </a>
                  <!-- Mail -->
                  <a x-bind:href="emailShareUrl" class="btn btn-icon-only" aria-label="Share via Email">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2zM20 6l-8 5-8-5h16zm0 12H4V8l8 5 8-5v10z"></path></svg>
                  </a>
                </div>
              </article>

              <!-- Right Column: Sidebar -->
              <aside class="news-sidebar">
                <!-- 1. Related Products Section -->
                <div class="sidebar-widget">
                  <h4 x-text="$store.i18n.t('productDetail.relatedProducts')">Related Products</h4>
                  <div class="related-products-list">
                    <!-- Case 1: Real data exists -->
                    <template x-if="relatedProducts.length > 0">
                      <template x-for="product in relatedProducts" :key="product.id">
                        <a :href="'product-details.html?id=' + product.id" class="related-product-item">
                          <img :src="window.fixImagePath(product.image_url) || 'img/coming-soon.jpg'" :alt="product.name[$store.i18n.lang] || product.name.id" />
                          <div class="related-product-details">
                            <p class="name" x-text="product.name[$store.i18n.lang] || product.name.id"></p>
                            <p class="price" x-text="formatRupiah(product.price)"></p>
                          </div>
                        </a>
                      </template>
                    </template>
                    <!-- Case 2: No real data, show placeholders -->
                    <template x-if="relatedProducts.length === 0">
                      <div>
                        <!-- Placeholder 1 -->
                        <a href="#" class="related-product-item placeholder">
                          <img src="img/coming-soon.jpg" alt="Placeholder Product" />
                          <div class="related-product-details">
                            <p class="name">Product Name</p>
                            <p class="price">Rp —</p>
                          </div>
                        </a>
                        <!-- Placeholder 2 -->
                        <a href="#" class="related-product-item placeholder">
                          <img src="img/coming-soon.jpg" alt="Placeholder Product" />
                          <div class="related-product-details">
                            <p class="name">Product Name</p>
                            <p class="price">Rp —</p>
                          </div>
                        </a>
                      </div>
                    </template>
                  </div>
                </div>

                <!-- 2. Latest News Section -->
                <div class="sidebar-widget">
                  <h4 x-text="$store.i18n.t('news.latest')">Latest News</h4>
                  <ul class="sidebar-news-list">
                    <template x-if="latestNews && latestNews.length > 0">
                      <template x-for="item in latestNews" :key="item.id">
                        <li>
                          <a :href="'news-detail.html?id=' + item.id">
                            <span x-text="item.title[$store.i18n.lang] || item.title.id"></span>
                            <small x-text="new Date(item.created_at).toLocaleDateString($store.i18n.lang, { year: 'numeric', month: 'short', day: 'numeric' })"></small>
                          </a>
                        </li>
                      </template>
                    </template>
                  </ul>
                </div>
              </aside>
            </div>
          </template>
        </div>
      </div>
    </main>

    <div id="notification" class="notification"></div>
    <div id="footer-include"></div>

    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-client.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.10/dist/cdn.min.js" defer></script>
    <script src="js/main.js"></script>
    <script src="js/news-detail.js"></script>
  </body>
</html>
